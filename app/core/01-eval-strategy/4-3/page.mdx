# Chapter 4.3 — Source-of-Truth Rules (Docs, Databases, Humans)

**What we're doing here:**
Ground truth is only as good as the **sources** behind it.
If your system (or your evaluators) don't know which sources are authoritative, you will get:
- conflicting answers,
- inconsistent labels,
- "it depends who reviewed it,"
- and production incidents when policy changes.

This chapter defines **source-of-truth rules**: a clear hierarchy of which data wins when sources disagree, and how to score outputs against that.

**Enterprise outcome:**
Everyone (models, raters, engineers, leadership) shares the same rules for:
- what is allowed to be used,
- what is authoritative,
- what must be cited,
- and when to abstain/escalate.

---

## 1) Mechanics: the "truth stack" concept

Think of truth as layers with different reliability and permissions:

- **Layer 1: Authoritative system records** (databases, billing, CRM)
- **Layer 2: Official policy docs** (terms, SLAs, internal policy pages)
- **Layer 3: Internal knowledge bases** (wikis, runbooks, FAQs)
- **Layer 4: Human experts** (legal, finance, support leads)
- **Layer 5: User-provided info** (what the user says)
- **Layer 6: Model general knowledge** (least reliable, often disallowed in enterprise)

You must decide:
- which layers the model may access for a task,
- and which layers the evaluator uses as the truth reference.

---

## 2) The enterprise rule: "highest authority wins" (with permission checks)

When sources conflict:
1. Check if the model is allowed to access the highest authority source
2. If allowed, that source wins
3. If not allowed, the model must:
   - abstain, or
   - ask for permission, or
   - route/escalate to a human/system

This prevents a common failure:
- The model uses a wiki statement while the billing database says something else.

---

## 3) Source categories and what they are good for

### 3.1 Databases and system-of-record (SOR)
Examples:
- billing DB
- order history
- CRM customer fields
- ticketing system status
- product configuration flags
- identity and access systems

**Best for**
- anything personalized (account, plan, usage, payments)
- anything that must be up-to-date

**Common trap**
- using "policy docs" to answer questions that require account-specific truth. Example: policy says "refunds possible," but database says "refund already issued."

---

### 3.2 Official docs and policy pages
Examples:
- Terms of service
- SLAs
- HR policies
- support policies

**Best for**
- contract/policy questions
- compliance guidance
- public-facing "what is allowed"

**Common trap**
- outdated docs. You need versioning and last-updated timestamps.

---

### 3.3 Internal wikis / runbooks / FAQs
Examples:
- engineering runbooks
- support macros
- onboarding guides

**Best for**
- operational how-to
- internal procedures
- non-legal guidance

**Common trap**
- wikis are often wrong or stale. They are helpful but not always authoritative.

---

### 3.4 Humans (experts, escalations)
Examples:
- legal counsel
- security team
- finance approvers
- senior support leads

**Best for**
- ambiguous policy decisions
- exceptions and special cases
- final sign-off for Tier 3 decisions

**Common trap**
- humans disagree too. You need adjudication and a final written policy output.

---

### 3.5 User-provided info
Examples:
- "My order number is X"
- "My address is Y"
- "I already paid"

**Best for**
- intent and context
- details that are not stored elsewhere

**Common trap**
- users can be mistaken or malicious. For high-risk flows, confirm with SOR.

---

### 3.6 Model general knowledge (the lowest authority)
In most enterprise systems, "general knowledge" is:
- allowed for low-risk generic education
- not allowed for policy/contract/account-specific decisions

**Common trap**
- model "fills gaps" with plausible but wrong facts.

---

## 4) Knobs & defaults (what you actually set)

### 4.1 Per-task allowed sources (policy)
For each leaf task, define:
- Allowed sources: DB / Docs / KB / Human / User info
- Forbidden sources: "general knowledge," external web, etc.
- When to abstain

**Default by task type**
- Chat (general): allowed general knowledge + user info (Tier 0–1)
- RAG: allowed only provided documents + citations
- Agents: allowed tools + system records + explicit user confirmations
- Voice: allowed system records + scripted policies + confirmations

### 4.2 Conflict resolution rule (must be written)
Example default:
- System-of-record > policy docs > internal wiki > user claim

### 4.3 Freshness rule
- If a source can change (policies, pricing, availability):
  - define required freshness window (e.g., "must be updated within 30 days")
  - define "last updated" metadata expectations
  - require abstain/escalate when freshness is unknown for Tier 2–3

### 4.4 Permission rule (privacy and tenant isolation)
- Even if a source is authoritative, access may be restricted:
  - tenant isolation
  - role-based access control
  - PII policies

Correct behavior when blocked:
- ask for permission or verification
- offer safe alternative
- escalate

---

## 5) How to bake source-of-truth into ground truth and scoring

### 5.1 For RAG
Ground truth should include:
- which doc(s) contain the answer
- what exact parts support the key claims
- when to abstain due to missing evidence

Scoring rule:
- unsupported claims lower grounding score
- confident unsupported claims are harshly penalized

### 5.2 For agents
Ground truth should include:
- which tool/system is the authority
- required confirmation steps
- expected final state (DB updated, ticket created, etc.)

Scoring rule:
- "nice explanation" doesn't count if system state isn't correct

### 5.3 For policy/compliance
Ground truth should include:
- the policy version and effective date
- who owns the policy
- escalation rules for exceptions

---

## 6) Failure modes (symptoms + root causes)

### 6.1 "Conflicting answers across channels"
Symptoms:
- chat says one thing, RAG says another, voice says another

Root causes:
- different sources allowed per channel
- missing conflict resolution policy
- inconsistent policy versions

Fix:
- single source-of-truth rulebook per product
- consistent policy artifacts across channels

---

### 6.2 "Model answers with stale policy"
Root causes:
- docs not versioned
- no freshness checks
- eval set not updated after policy changes

Fix:
- policy versioning + ownership + review cadence
- ground truth version updates tied to policy changes

---

### 6.3 "Model leaks private data"
Root causes:
- no permission gating
- tools expose too much
- missing privacy red-team suite

Fix:
- strict PII gating and least privilege
- privacy eval suite as release gate

---

### 6.4 "Wiki says X, system says Y"
Root causes:
- wiki not maintained
- no explicit authority ordering

Fix:
- system-of-record wins
- wiki must reference SOR or be demoted

---

## 7) Debug playbook: build a source-of-truth rulebook

### Step 1 — Create a "Truth Registry"
List each domain area:
- billing
- refunds
- SLAs
- account status
- security
- product features

For each, record:
- authoritative source
- owner team
- update cadence
- escalation contact

### Step 2 — Encode per-task allowed sources
Add it to your taxonomy table as a column:
- AllowedSources = [DB, Docs, KB, Human, User]

### Step 3 — Add conflict resolution examples
Create 10–30 "conflict cases" where sources disagree and define:
- what wins
- what the assistant should say

### Step 4 — Turn into eval packs
- "Stale policy pack"
- "Conflicting sources pack"
- "Permission denied pack"

---

## 8) Enterprise expectations (what serious teams do)

- Maintain a formal **Source-of-Truth Registry**
- Have policy owners and "effective dates"
- Tie eval ground truth to:
  - doc versions
  - system-of-record snapshots
- Enforce tenant isolation and access control
- Create audit trails:
  - which sources were used
  - which policy triggered
  - which tool was called

---

## 9) Ready-to-use templates

### 9.1 Source-of-Truth Registry (copy/paste)

| Domain | Primary Source (SOR) | Secondary Docs | Owner Team | Update Cadence | Freshness Requirement | Escalation Path |
|---|---|---|---|---|---|---|
| Billing/Plan | Billing DB | Pricing policy doc | Finance | Daily | Must be current | Finance on-call |
| Refunds | Billing DB | Refund policy | Support Ops | Weekly | ≤ 30 days | Support lead |
| SLA | Contract DB / Legal repo | SLA doc | Legal | As needed | Must match contract version | Legal counsel |
| Account Status | Auth DB | Help center | Security | Real-time | Must be current | SecOps |

### 9.2 Per-task allowed sources snippet (copy/paste)

**Task:** Retrieve refund eligibility
**Allowed:** Billing DB + Refund policy doc
**Forbidden:** General knowledge
**If conflict:** Billing DB wins
**If missing:** abstain + request the missing source / escalate

---
